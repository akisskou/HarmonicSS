<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html" charset="ISO-8859-1">
<title>View Execution Data</title>
	<style>
	table, th, td {
  		border: 1px solid black;
  		border-collapse: collapse;
	}
	table {
    	table-layout: auto;
    	width: 100%;
	}
	</style>
</head>
<body onload="getDataFromDB()">
	<div class="container">
		<p><a href="index.html">Home</a></p>
		<input type="text" id="userID" placeholder="user ID">
		<input type="text" id="requestID" placeholder="request ID">
		<button onclick='getDataFromDB()'>View requests</button><br><br>
        
		<h3>Execution Data Table</h3>
        <div id="data">
        </div>
    </div>
    
    <!-- 4 include the jQuery library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>   
	<script type="text/javascript">
	
	function getDataFromDB() {
		$('#data').html("<h4>Collecting data from DB...</h4>");
 		var HttpClient = function() {
 			this.get = function(aUrl, aCallback) {
 				var anHttpRequest = new XMLHttpRequest();
 				anHttpRequest.onreadystatechange = function() { 
 					if (anHttpRequest.readyState == 4 && anHttpRequest.status == 200)
 						aCallback(anHttpRequest.responseText);
 					}
 				anHttpRequest.open( "GET", aUrl, true ); 
 				anHttpRequest.send( null ); 
 			}
 		}
 		var requestID = document.getElementById("requestID");
 		var userID = document.getElementById("userID");
 		var theurl='ReqRespList?userID='+userID.value.trim()+'&requestID='+requestID.value.trim();
 		
 		var client = new HttpClient();
 		client.get(theurl, function(response) { 
			var response1 = JSON.parse(response);
			var htmldata='<table table-layout="auto" width="100%"><tr><th>USER ID</th><th>REQUEST ID</th><th>REQUEST SYNOPSIS</th><th>EXECUTION DATE</th><th>RESPONSE SYNOPSIS</th></tr>';
			var dbList = response1.request_response_list;
			for(i=0; i<dbList.length; i++){
				htmldata += '<tr align="center"><td>'+dbList[i].user_id+'</td><td>'+dbList[i].request_id+'</td><td>'+dbList[i].request_synopsis+'</td><td>'+dbList[i].execution_date+'</td><td>'+dbList[i].response_synopsis+'</td></tr>';
			}
			htmldata += '</table>';
			$('#data').html(htmldata);
		});
	}
	</script>
</body>
</html>